function gr_avg = compute_grid_avg(gr_val)

num1 = size(gr_val,1);
num2 = size(gr_val,2);
num3 = size(gr_val,3);

ind1_1 = 1:num1-1; ind2_1 = 1:num2-1; ind3_1 = 1:num3-1;
ind1_2 = ind1_1+1; ind2_2 = ind2_1+1; ind3_2 = ind3_1+1;

gr_avg = (gr_val(ind1_1,ind2_1,ind3_1) + ...
          gr_val(ind1_1,ind2_1,ind3_2) + ...
          gr_val(ind1_1,ind2_2,ind3_1) + ...
          gr_val(ind1_1,ind2_2,ind3_2) + ...
          gr_val(ind1_2,ind2_1,ind3_1) + ...
          gr_val(ind1_2,ind2_1,ind3_2) + ...
          gr_val(ind1_2,ind2_2,ind3_1) + ...
          gr_val(ind1_2,ind2_2,ind3_2))/8;
end